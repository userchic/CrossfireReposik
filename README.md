# Перестрелка

Данный репозиторий является продолжением давно выполненной моей курсовой работы 2 курса, которая была выполнена кое как.
## Смысл игры

Игра состоит в том, что несколько команд по сколько то человек противостоят друг другу. Они решают задачи и при этом они могут указать цель, которая при правильном ответе будет с некоторой вероятностью поражена выстрелом. Выстрел отнимет некоторое количество очков целевой команды.

Игра может кончиться по времени либо когда все команды решат все задачи.

Игра по-моему аналогов не имеет.

## КР 2 курса

Тогда было сделано не так много:

- Было создано 3 контроллера в которых по-моему была логика приложения.
- Использовался старый EF вместо EF Core потому что у еня тогда была VS2018, ну и версия ASP .Net Core была другая, та версия в которой ещё был файл StartUp. Возможно 5 версия
- БД была очень небольшая, 4 таблицы связанные последовательно в виде линии(ну или можно привести аналогию с деревом ид теории графов)
- Требования говорили что игра должна быть командной и онлайн, но этого не было. Игрок играл против генератора случайных чисел.
- в рамках игры был таймер, но он был на фронтэнде(в представлениях). То есть таймер был не постоянным и его значения таскались из одного представления игры в другое.
- В приложении не было аутентификации и авторизации. Была только их имитация.
- СУБД была MS SQL

## Отчёт
Сейчас в приложении:
- более менее работают 3 контроллера: домашний, который почти всегда используется не зарегистрированным пользователем, контроллер администратора занимающегося играми и задачами и контроллер игрока в котором есть работа с командами и игровой процесс.
- есть аутентификация и авторизация по ролям, ролей существует 2 - Администратор и игрок. Но пароли ни хешируются, никак не кодируются, хранятся в чистом виде.
- нет такого понятия как принадлежность задачи кому то, задачи при создании игр добавляются из списка всех задач системы, списка который не подгружается и соответственно к котором есть вообще все задачи созданные кем угодно
- Используется EF Core, База данных состоит из где-то 15 таблиц из которых по-моему 3 таблицы это словари и еще 3 таблицы это отношения многие ко многим. 
- базе данных соответствуют модели, к которым создано 10 репозиториев с интерфейсами(это 10 Scoped сервисов)
- СУБД PostgreSQL, выбрана для того чтобы использовать что-то новое
- Таймер как будто сделан, но он не отображается и упорно не хочет этого делать, как бы я не описывал изменение отображаемого значения таймера(оно не отображается вообще)


Для игрового процесса добавлены и разрабатываются: 
- хаб для подключения по TCP соединению чтобы отправлять игрокам сообщения об отправленных ответах (библиотека SignalR)
- поскольку игры на самом деле запланировываются на будущее, добавлен менеджер игр, который пока что будет Singleton сервисом. Он будет хранить список запланированных игр, добавлять в этот список новые игры при создании, и игры будут вести отсчёт времени до своего начала и затем до своего конца после чего они сообщат менеджеру игр по ссылке что они закончились и он сообщит хабу об этом. Хабу об этом нужно знать потому что если игра закончится не по таймеру нужно всем игрокам сообщить, а ведь игра может закончиться когда игроки всё решат.
- Скорее всего менеджер будет удалён так как при нормальной работе с приложением каждый клиент завершит игру по времени самостоятельно и ответы на задачи после окончания игры отправить всё равно невозможно.
- Есть 1 вид задач в которых есть текст и правильный ответ являющийся последовательностью символов, с которой сверяется сервер при проверке отправленных ответов.
- Во время игры ещё нельзя увидеть список команд и присутствующих в игре игроков(присутствующих, то есть играющих в данный момент)